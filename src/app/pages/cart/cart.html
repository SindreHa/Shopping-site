<h1 class="text-3xl mb-10">Shopping cart</h1>

@if (emptyCart$()) {
    <div>Your cart is empty.</div>
} @else {
    <div
        class="w-full text-sm text-left rounded-lg border border-2 border-gray-400 overflow-hidden"
    >
        <div
            class="flex text-xs pl-3 sm:pl-5 sm:pr-1 text-gray-700 uppercase bg-white border-b border-gray-300 text-right"
        >
            <div class="py-3 flex-1 text-left">Product name</div>
            <div class="py-3 w-22 text-center">Quantity</div>
            <div class="py-3 w-22">Prize</div>
            <div class="py-3 w-22 hidden sm:block">Total</div>
            <div class="py-3 w-10"></div>
        </div>

        @for (item of items$(); track item.id) {
            <div
                class="flex text-right pl-3 sm:pl-5 sm:pr-1"
                [class.bg-white]="$odd"
                [class.bg-gray-100]="$even"
            >
                <div
                    class="py-4 flex-1 font-medium whitespace-nowrap text-left overflow-hidden text-ellipsis"
                >
                    {{ item.product.name }}
                </div>
                <div class="py-4 w-22 text-center">
                    <button
                        [disabled]="item.quantity === 1"
                        [class.hover:bg-blue-600]="item.quantity > 1"
                        [class.hover:text-white]="item.quantity > 1"
                        [class.bg-gray-200]="item.quantity === 1"
                        [class.bg-gray-300]="item.quantity > 1"
                        [class.cursor-pointer]="item.quantity > 1"
                        (click)="updateQuantity(item.product.id, -1)"
                        class="text-gray-800 px-2 rounded-l"
                    >
                        -
                    </button>
                    <span class="px-2">{{ item.quantity }}</span>
                    <button
                        (click)="updateQuantity(item.product.id, 1)"
                        class="bg-gray-300 cursor-pointer  px-2 rounded-r hover:bg-blue-600 hover:text-white"
                    >
                        +
                    </button>
                </div>
                <div class="py-4 w-22">
                    {{ item.product.price | currency }}
                </div>
                <div class="py-4 w-22 hidden sm:block">
                    {{ item.product.price * item.quantity | currency }}
                </div>
                <div class="py-4 w-10 text-center">
                    <button
                        (click)="removeItem(item.product.id)"
                        class="h-full w-full block cursor-pointer text-md text-red-600 hover:text-red-800 font-bold"
                    >
                        &times;
                    </button>
                </div>
            </div>
        }

        <div
            class="flex border-t border-gray-300 pl-3 sm:pl-5 sm:pr-1 text-gray-700 uppercase bg-white border-b border-gray-300 text-right"
        >
            <div class="py-2 flex-1 text-left"></div>
            <div class="py-2 w-22 text-center">{{ numberOfItemsInCart$() }}</div>
            <div class="py-2 w-22"></div>
            <div class="py-2 w-22 hidden sm:block">{{ cartTotal$() | currency }}</div>
            <div class="py-2 w-10"></div>
        </div>
    </div>
}

@if (!emptyCart$()) {
    <div class="mt-4 flex justify-between items-center">
        <p class="text-xl font-semibold">Total: {{ cartTotal$() | currency }}</p>
        <button
            (click)="clear()"
            class="cursor-pointer bg-red-900 hover:bg-red-700 transition text-white px-4 py-2 rounded"
        >
            Clear Cart
        </button>
    </div>
}
